import{_ as n,c as s}from"./app.1c29f384.js";var a="/../../assets/\u53CC\u5411\u94FE\u8868-1.28ba87ed.png",e="/../../assets/\u53CC\u5411\u94FE\u8868-2.7c5ccd81.png";const p={},t=s(`<h1 id="\u624B\u5199-lru" tabindex="-1"><a class="header-anchor" href="#\u624B\u5199-lru" aria-hidden="true">#</a> \u624B\u5199 LRU</h1><h2 id="\u9898\u76EE" tabindex="-1"><a class="header-anchor" href="#\u9898\u76EE" aria-hidden="true">#</a> \u9898\u76EE</h2><p>\u7528 JS \u5B9E\u73B0\u4E00\u4E2A LRU \u7F13\u5B58</p><h2 id="lru-\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#lru-\u4F7F\u7528" aria-hidden="true">#</a> LRU \u4F7F\u7528</h2><p>Least Recently Used \u6700\u8FD1\u6700\u5C11\u4F7F\u7528<br> \u5373\u6DD8\u6C70\u6389\u6700\u8FD1\u6700\u5C11\u4F7F\u7528\u7684\u6570\u636E\uFF0C\u53EA\u4FDD\u7559\u6700\u8FD1\u7ECF\u5E38\u4F7F\u7528\u7684\u8D44\u6E90\u3002\u5B83\u662F\u4E00\u4E2A\u56FA\u5B9A\u5BB9\u91CF\u7684\u7F13\u5B58\u5BB9\u5668\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> lruCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LRUCache</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u6700\u5927\u7F13\u5B58\u957F\u5EA6 2</span>
lruCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u7F13\u5B58\u662F {1=1}</span>
lruCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u7F13\u5B58\u662F {1=1, 2=2}</span>
lruCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// \u8FD4\u56DE 1</span>
lruCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8BE5\u64CD\u4F5C\u4F1A\u4F7F\u5F97\u5173\u952E\u5B57 2 \u4F5C\u5E9F\uFF0C\u7F13\u5B58\u662F {1=1, 3=3}</span>
lruCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// \u8FD4\u56DE null</span>
lruCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8BE5\u64CD\u4F5C\u4F1A\u4F7F\u5F97\u5173\u952E\u5B57 1 \u4F5C\u5E9F\uFF0C\u7F13\u5B58\u662F {4=4, 3=3}</span>
lruCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// \u8FD4\u56DE null</span>
lruCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// \u8FD4\u56DE 3</span>
lruCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// \u8FD4\u56DE 4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u5206\u6790" aria-hidden="true">#</a> \u5206\u6790</h2><ul><li>\u54C8\u5E0C\u8868\uFF0C\u5373 <code>{ k1: v1, k2: v2, ... }</code> \u5F62\u5F0F\u3002\u53EF\u4EE5 <code>O(1)</code> \u4E8B\u4EF6\u590D\u6742\u5EA6\u5B58\u53D6 <code>key</code> <code>value</code></li><li>\u6709\u5E8F\u3002\u53EF\u4EE5\u6839\u636E\u6700\u8FD1\u4F7F\u7528\u60C5\u51B5\u6E05\u7406\u7F13\u5B58</li></ul><p>JS \u5185\u7F6E\u7684\u6570\u636E\u7ED3\u6784\u7C7B\u578B <code>Object</code> <code>Array</code> <code>Set</code> <code>Map</code> \uFF0C\u6070\u597D <code>Map</code> \u7B26\u5408\u8FD9\u4E24\u6761\u8981\u6C42</p><h2 id="map-\u662F\u6709\u5E8F\u7684" tabindex="-1"><a class="header-anchor" href="#map-\u662F\u6709\u5E8F\u7684" aria-hidden="true">#</a> Map \u662F\u6709\u5E8F\u7684</h2><p>Map \u6709\u5E8F\uFF0CObject \u65E0\u5E8F</p><h2 id="\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u73B0" aria-hidden="true">#</a> \u5B9E\u73B0</h2><p>\u4EE3\u7801\u53C2\u8003 LRU.ts</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@description</span> LRU cache
 * <span class="token keyword">@author</span> \u53CC\u8D8A\u8001\u5E08
 */</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">LRUCache</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> length<span class="token operator">:</span> <span class="token builtin">number</span>
    <span class="token keyword">private</span> data<span class="token operator">:</span> Map<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span>length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;invalid length&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length
    <span class="token punctuation">}</span>

    <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data

        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        data<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>size <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u5982\u679C\u8D85\u51FA\u4E86\u5BB9\u91CF\uFF0C\u5219\u5220\u9664 Map \u6700\u8001\u7684\u5143\u7D20</span>
            <span class="token keyword">const</span> delKey <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
            data<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>delKey<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span>

        <span class="token keyword">const</span> value <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>

        data<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        data<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>

        <span class="token keyword">return</span> value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// const lruCache = new LRUCache(2)</span>
<span class="token comment">// lruCache.set(1, 1) // {1=1}</span>
<span class="token comment">// lruCache.set(2, 2) // {1=1, 2=2}</span>
<span class="token comment">// console.info(lruCache.get(1)) // 1 {2=2, 1=1}</span>
<span class="token comment">// lruCache.set(3, 3) // {1=1, 3=3}</span>
<span class="token comment">// console.info(lruCache.get(2)) // null</span>
<span class="token comment">// lruCache.set(4, 4) // {3=3, 4=4}</span>
<span class="token comment">// console.info(lruCache.get(1)) // null</span>
<span class="token comment">// console.info(lruCache.get(3)) // 3 {4=4, 3=3}</span>
<span class="token comment">// console.info(lruCache.get(4)) // 4 {3=3, 4=4}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF0C<code>get</code> <code>set</code> \u65F6\u90FD\u8981\u628A\u64CD\u4F5C\u6570\u636E\u79FB\u52A8\u5230 Map \u6700\u65B0\u7684\u4F4D\u7F6E\u3002</p><h2 id="\u6269\u5C55" tabindex="-1"><a class="header-anchor" href="#\u6269\u5C55" aria-hidden="true">#</a> \u6269\u5C55</h2><p>\u5B9E\u9645\u9879\u76EE\u4E2D\u53EF\u4EE5\u4F7F\u7528\u7B2C\u4E09\u65B9 lib</p><ul><li>https://www.npmjs.com/package/quick-lru</li><li>https://www.npmjs.com/package/lru-cache</li><li>https://www.npmjs.com/package/tiny-lru</li><li>https://www.npmjs.com/package/mnemonist</li></ul><h2 id="\u8FDE\u73AF\u95EE-\u4E0D\u7528-map-\u5982\u4F55\u5B9E\u73B0-lru-cache" tabindex="-1"><a class="header-anchor" href="#\u8FDE\u73AF\u95EE-\u4E0D\u7528-map-\u5982\u4F55\u5B9E\u73B0-lru-cache" aria-hidden="true">#</a> \u8FDE\u73AF\u95EE\uFF1A\u4E0D\u7528 Map \u5982\u4F55\u5B9E\u73B0 LRU cache \uFF1F</h2><p>LRU cache \u662F\u5F88\u65E9\u5C31\u6709\u7684\u7B97\u6CD5\uFF0C\u800C Map \u4EC5\u4EC5\u662F\u8FD9\u51E0\u5E74\u624D\u52A0\u5165\u7684 ES \u8BED\u6CD5\u3002</p><h3 id="\u4F7F\u7528-object-\u548C-array" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-object-\u548C-array" aria-hidden="true">#</a> \u4F7F\u7528 Object \u548C Array</h3><p>\u6839\u636E\u4E0A\u6587\u7684\u5206\u6790\uFF0C\u4E24\u4E2A\u6761\u4EF6</p><ul><li>\u54C8\u5E0C\u8868\uFF0C\u53EF\u4EE5\u7528 <code>Object</code> \u5B9E\u73B0</li><li>\u6709\u5E8F\uFF0C\u53EF\u4EE5\u7528 <code>Array</code> \u5B9E\u73B0</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u6267\u884C lru.set(&#39;a&#39;, 1) lru.set(&#39;b&#39;, 2) lru.set(&#39;c&#39;, 3) \u540E\u7684\u6570\u636E</span>

<span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;a&#39;</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;b&#39;</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> obj3 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;c&#39;</span> <span class="token punctuation">}</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">,</span> obj3<span class="token punctuation">]</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string-property property">&#39;a&#39;</span><span class="token operator">:</span> obj1<span class="token punctuation">,</span> <span class="token string-property property">&#39;b&#39;</span><span class="token operator">:</span> obj2<span class="token punctuation">,</span> <span class="token string-property property">&#39;c&#39;</span><span class="token operator">:</span> obj3 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6A21\u62DF <code>get</code> <code>set</code> \u64CD\u4F5C\uFF0C\u4F1A\u53D1\u73B0\u51E0\u4E2A\u95EE\u9898\uFF0C\u90FD\u6765\u81EA\u4E8E\u6570\u7EC4</p><ul><li>\u8D85\u51FA cache \u5BB9\u91CF\u65F6\uFF0C\u8981\u79FB\u9664\u6700\u65E9\u7684\u5143\u7D20\uFF0C\u6570\u7EC4 <code>shift</code> \u6548\u7387\u4F4E</li><li>\u6BCF\u6B21 <code>get</code> <code>set</code> \u65F6\u90FD\u8981\u628A\u5F53\u524D\u5143\u7D20\u79FB\u52A8\u5230\u6700\u65B0\u7684\u4F4D\u7F6E\uFF0C\u6570\u7EC4 <code>splice</code> \u6548\u7387\u4F4E</li></ul><h3 id="array-\u6539\u4E3A\u53CC\u5411\u94FE\u8868" tabindex="-1"><a class="header-anchor" href="#array-\u6539\u4E3A\u53CC\u5411\u94FE\u8868" aria-hidden="true">#</a> Array \u6539\u4E3A\u53CC\u5411\u94FE\u8868</h3><p>\u6570\u7EC4\u6709\u95EE\u9898\uFF0C\u5C31\u9700\u8981\u4F7F\u7528\u65B0\u7684\u6570\u636E\u7ED3\u6784 <strong>\u53CC\u5411\u94FE\u8868</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>Interface INode <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token builtin">any</span>
    next<span class="token operator">?</span><span class="token operator">:</span> INode
    prev<span class="token operator">?</span><span class="token operator">:</span> INode
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53CC\u5411\u94FE\u8868\u53EF\u4EE5\u5FEB\u901F\u79FB\u52A8\u5143\u7D20\u3002\u672B\u5C3E\u65B0\u589E\u5143\u7D20 D \u5F88\u7B80\u5355\uFF0C\u5F00\u5934\u5220\u9664 A \u5143\u7D20\u4E5F\u5F88\u7B80\u5355\u3002</p><p><img src="`+a+'" alt=""></p><p>\u8981\u628A\u4E2D\u95F4\u7684\u5143\u7D20 B \u79FB\u52A8\u5230\u6700\u540E\uFF08\u5982 LRU <code>set</code> <code>get</code> \u65F6\u79FB\u52A8\u6570\u636E\u4F4D\u7F6E\uFF09\uFF0C\u53EA\u9700\u8981\u4FEE\u6539\u524D\u540E\u7684\u6307\u9488\u5373\u53EF\uFF0C\u6548\u7387\u5F88\u9AD8\u3002</p><p><img src="'+e+`" alt=""></p><h3 id="\u5B9E\u73B0-1" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u73B0-1" aria-hidden="true">#</a> \u5B9E\u73B0</h3><p>\u4EE3\u7801\u53C2\u8003 LRU2.ts</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@description</span> LRU \u7F13\u5B58 - \u4E0D\u4F7F\u7528 Map
 * <span class="token keyword">@author</span> \u53CC\u8D8A\u8001\u5E08
 */</span>

<span class="token keyword">interface</span> <span class="token class-name">IListNode</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token builtin">any</span>
    key<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token comment">// \u5B58\u50A8 key \uFF0C\u65B9\u4FBF\u5220\u9664\uFF08\u5426\u5219\u5220\u9664\u65F6\u5C31\u9700\u8981\u904D\u5386 this.data )</span>
    prev<span class="token operator">?</span><span class="token operator">:</span> IListNode
    next<span class="token operator">?</span><span class="token operator">:</span> IListNode
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">LRUCache</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> length<span class="token operator">:</span> <span class="token builtin">number</span>
    <span class="token keyword">private</span> data<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> IListNode <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">private</span> dataLength<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">private</span> listHead<span class="token operator">:</span> IListNode <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">private</span> listTail<span class="token operator">:</span> IListNode <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span>length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;invalid length&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">moveToTail</span><span class="token punctuation">(</span>curNode<span class="token operator">:</span> IListNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> tail <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listTail
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tail <span class="token operator">===</span> curNode<span class="token punctuation">)</span> <span class="token keyword">return</span>

        <span class="token comment">// -------------- 1. \u8BA9 prevNode nextNode \u65AD\u7EDD\u4E0E curNode \u7684\u5173\u7CFB --------------</span>
        <span class="token keyword">const</span> prevNode <span class="token operator">=</span> curNode<span class="token punctuation">.</span>prev
        <span class="token keyword">const</span> nextNode <span class="token operator">=</span> curNode<span class="token punctuation">.</span>next
        <span class="token keyword">if</span> <span class="token punctuation">(</span>prevNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nextNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                prevNode<span class="token punctuation">.</span>next <span class="token operator">=</span> nextNode
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">delete</span> prevNode<span class="token punctuation">.</span>next
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nextNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>prevNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                nextNode<span class="token punctuation">.</span>prev <span class="token operator">=</span> prevNode
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">delete</span> nextNode<span class="token punctuation">.</span>prev
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listHead <span class="token operator">===</span> curNode<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listHead <span class="token operator">=</span> nextNode
        <span class="token punctuation">}</span>

        <span class="token comment">// -------------- 2. \u8BA9 curNode \u65AD\u7EDD\u4E0E prevNode nextNode \u7684\u5173\u7CFB --------------</span>
        <span class="token keyword">delete</span> curNode<span class="token punctuation">.</span>prev
        <span class="token keyword">delete</span> curNode<span class="token punctuation">.</span>next

        <span class="token comment">// -------------- 3. \u5728 list \u672B\u5C3E\u91CD\u65B0\u5EFA\u7ACB curNode \u7684\u65B0\u5173\u7CFB --------------</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tail<span class="token punctuation">.</span>next <span class="token operator">=</span> curNode
            curNode<span class="token punctuation">.</span>prev <span class="token operator">=</span> tail
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>listTail <span class="token operator">=</span> curNode
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">tryClean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataLength <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> head <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listHead
            <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;head is null&#39;</span><span class="token punctuation">)</span>
            <span class="token keyword">const</span> headNext <span class="token operator">=</span> head<span class="token punctuation">.</span>next
            <span class="token keyword">if</span> <span class="token punctuation">(</span>headNext <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;headNext is null&#39;</span><span class="token punctuation">)</span>

            <span class="token comment">// 1. \u65AD\u7EDD head \u548C next \u7684\u5173\u7CFB</span>
            <span class="token keyword">delete</span> headNext<span class="token punctuation">.</span>prev
            <span class="token keyword">delete</span> head<span class="token punctuation">.</span>next

            <span class="token comment">// 2. \u91CD\u65B0\u8D4B\u503C listHead</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>listHead <span class="token operator">=</span> headNext

            <span class="token comment">// 3. \u6E05\u7406 data \uFF0C\u91CD\u65B0\u8BA1\u6570</span>
            <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>head<span class="token punctuation">.</span>key<span class="token punctuation">]</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataLength <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataLength <span class="token operator">-</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data
        <span class="token keyword">const</span> curNode <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>curNode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listTail <span class="token operator">===</span> curNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u672C\u8EAB\u5728\u672B\u5C3E\uFF08\u6700\u65B0\u9C9C\u7684\u4F4D\u7F6E\uFF09\uFF0C\u76F4\u63A5\u8FD4\u56DE value</span>
            <span class="token keyword">return</span> curNode<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span>

        <span class="token comment">// curNode \u79FB\u52A8\u5230\u672B\u5C3E</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveToTail</span><span class="token punctuation">(</span>curNode<span class="token punctuation">)</span>

        <span class="token keyword">return</span> curNode<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>

    <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data
        <span class="token keyword">const</span> curNode <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>curNode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u65B0\u589E\u6570\u636E</span>
            <span class="token keyword">const</span> newNode<span class="token operator">:</span> IListNode <span class="token operator">=</span> <span class="token punctuation">{</span> key<span class="token punctuation">,</span> value <span class="token punctuation">}</span>
            <span class="token comment">// \u79FB\u52A8\u5230\u672B\u5C3E</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveToTail</span><span class="token punctuation">(</span>newNode<span class="token punctuation">)</span>

            data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newNode
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataLength<span class="token operator">++</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataLength <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listHead <span class="token operator">=</span> newNode
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u4FEE\u6539\u73B0\u6709\u6570\u636E</span>
            curNode<span class="token punctuation">.</span>value <span class="token operator">=</span> value
            <span class="token comment">// \u79FB\u52A8\u5230\u672B\u5C3E</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveToTail</span><span class="token punctuation">(</span>curNode<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// \u5C1D\u8BD5\u6E05\u7406\u957F\u5EA6</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">tryClean</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// const lruCache = new LRUCache(2)</span>
<span class="token comment">// lruCache.set(&#39;1&#39;, 1) // {1=1}</span>
<span class="token comment">// lruCache.set(&#39;2&#39;, 2) // {1=1, 2=2}</span>
<span class="token comment">// console.info(lruCache.get(&#39;1&#39;)) // 1 {2=2, 1=1}</span>
<span class="token comment">// lruCache.set(&#39;3&#39;, 3) // {1=1, 3=3}</span>
<span class="token comment">// console.info(lruCache.get(&#39;2&#39;)) // null</span>
<span class="token comment">// lruCache.set(&#39;4&#39;, 4) // {3=3, 4=4}</span>
<span class="token comment">// console.info(lruCache.get(&#39;1&#39;)) // null</span>
<span class="token comment">// console.info(lruCache.get(&#39;3&#39;)) // 3 {4=4, 3=3}</span>
<span class="token comment">// console.info(lruCache.get(&#39;4&#39;)) // 4 {3=3, 4=4}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\u4E8B\u9879</p><ul><li>\u6570\u636E\u7ED3\u6784\u5982\u4F55\u5B9A\u4E49\uFF0C<code>data</code> \u548C\u94FE\u8868\u5206\u522B\u5B58\u50A8\u4EC0\u4E48</li><li>\u53CC\u5411\u94FE\u8868\u7684\u64CD\u4F5C\uFF08\u975E\u5E38\u7E41\u7410\uFF0C\u5199\u4EE3\u7801\u5F88\u5BB9\u6613\u51FA\u9519\uFF0C\u903B\u8F91\u4E00\u5B9A\u8981\u6E05\u6670\uFF01\uFF01\uFF01\uFF09</li><li>\u94FE\u8868 <code>node</code> \u4E2D\u8981\u5B58\u50A8 <code>data.key</code> \uFF0C\u5426\u5219\u5220\u9664 <code>data</code> \u9700\u8981\u904D\u5386\u3001\u6548\u7387\u4F4E</li></ul>`,38);function o(c,l){return t}var u=n(p,[["render",o],["__file","11-\u624B\u5199LRU.html.vue"]]);export{u as default};
